<!DOCTYPE html>
<html>
<head>


  <title>Pixel Canvas</title>
    
  <style>
    body {
      background: #e0e0e0;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    .container {
      width: 90%;
      max-width: 1080px;
      background: #e0e0e0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #canvas {
      width: 100%;
      height: 0;
      padding-bottom: 100%;
      background: #e0e0e0;
      box-shadow:  20px 20px 60px #bebebe, 
                   -20px -20px 60px #ffffff;
      margin-bottom: 20px;
    }

    .controls {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      width: 100%;
    }

    .controls > * {
      box-shadow:  20px 20px 60px #bebebe, 
                   -20px -20px 60px #ffffff;
      border: none;
      padding: 10px 20px;
      border-radius: 30px;
      background: #e0e0e0;
      font-size: 1rem;
      outline: none;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 10px;
    }

    .controls > *:active {
      box-shadow: inset 5px 5px 10px #bebebe, 
                  inset -5px -5px 10px #ffffff;
    }

    @media screen and (min-width: 600px) {
      .controls {
        flex-direction: row;
        justify-content: space-between;
      }
    }
  </style>

</head>
<body>
  <div class="container">
    <canvas id="canvas" width="1080" height="1080"></canvas>
    <div class="controls">
      <input type="color" id="color-picker">
      <button class="delete-button" onclick="deleteCanvas()">Delete Canvas</button>
      <button class="screenshot-button" onclick="captureScreenshot()">Take Screenshot</button>
      <button class="eraser-button" onclick="toggleEraser()">Eraser</button>
    </div>
  </div>

  <script>
    var canvas = document.getElementById('canvas');
    var ctx = canvas.getContext('2d');
    var colorPicker = document.getElementById('color-picker');
    var gridSize = 10;
    var eraserActive = false;

    function drawPixel(x, y, color) {
      ctx.fillStyle = color;
      ctx.fillRect(x, y, gridSize, gridSize);
    }

    function erasePixel(x, y) {
      ctx.clearRect(x, y, gridSize, gridSize);
    }

    // Load pixel data from localStorage
    var pixelDataString = localStorage.getItem('pixelData');
    if (pixelDataString) {
      var pixelData = JSON.parse(pixelDataString);
      pixelData.forEach(pixel => {
        drawPixel(pixel.x, pixel.y, pixel.color);
      });
    } else {
      pixelData = [];
    }

    // Handle drawing for both click and touch events
    var handleDrawing = function(e) {
      e.preventDefault();

      var x, y;

      if (e.type === 'click') {
        x = e.clientX;
        y = e.clientY;
      } else if (e.type === 'touchstart') {
        x = e.touches[0].clientX;
        y = e.touches[0].clientY;
      }

      var rect = canvas.getBoundingClientRect();
      var scaleX = canvas.width / rect.width;
      var scaleY = canvas.height / rect.height;

      var canvasX = (x - rect.left) * scaleX;
      var canvasY = (y - rect.top) * scaleY;

      var gridX = Math.floor(canvasX / gridSize) * gridSize;
      var gridY = Math.floor(canvasY / gridSize) * gridSize;

      if (eraserActive) {
        erasePixel(gridX, gridY);

        // Remove erased pixel from pixelData array
        pixelData = pixelData.filter(pixel => pixel.x !== gridX || pixel.y !== gridY);
        localStorage.setItem('pixelData', JSON.stringify(pixelData));
      } else {
        // Draw pixel on canvas
        drawPixel(gridX, gridY, colorPicker.value);

        // Store pixel in array
        pixelData.push({
          x: gridX,
          y: gridY,
          color: colorPicker.value
        });

        // Save pixel data in localStorage
        localStorage.setItem('pixelData', JSON.stringify(pixelData));
      }
    };

    // Add event listeners for both click and touch events
    canvas.addEventListener('click', handleDrawing);
    canvas.addEventListener('touchstart', handleDrawing);

    // Function to delete the canvas and clear the pixel data
    function deleteCanvas() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      pixelData = [];
      localStorage.removeItem('pixelData');
    }

    // Function to capture a screenshot of the canvas
    function captureScreenshot() {
      var tempCanvas = document.createElement('canvas');
      var tempCtx = tempCanvas.getContext('2d');
      tempCanvas.width = canvas.width;
      tempCanvas.height = canvas.height;
      tempCtx.fillStyle = '#ffffff';
      tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
      tempCtx.drawImage(canvas, 0, 0);

      var link = document.createElement('a');
      link.href = tempCanvas.toDataURL();
      link.download = 'screenshot.png';
      link.click();
    }

    // Function to toggle the eraser functionality
    function toggleEraser() {
      eraserActive = !eraserActive;

      // Update button text based on eraser state
      var eraserButton = document.querySelector('.eraser-button');
      eraserButton.textContent = eraserActive ? 'Stop Eraser' : 'Eraser';
    }
  </script>
</body>
</html>
